<%

def sidebar_link_to(link)
	path = link[:path]
	icon = link[:icon]
	text = link[:text]

	active = 'dark:bg-gray-800 dark:text-gray-50' if current_page?(path)
	tag.li class: "px-2 w-full overflow-hidden h-12 flex items-center #{active} sm:px-0" do
		link_to(path, class: 'flex items-center sm:px-5 space-x-3 rounded-md') do
		concat tag.span icon
		concat tag.span " #{text}", class: 'inline-block sm:hidden lg:inline-block'
		end
	end
end

links = [
	{ path: root_path, icon: "ğŸ–¥ï¸", text: "Dashboard" },
	{ path: future_log_path, icon: "ğŸ“…", text: "Logs" },
	{ path: tasks_path, icon: "âœ…", text: "Tasks" },
	{ path: words_path, icon: "ğŸ”¤", text: "Words" },
	{ path: books_path, icon: "ğŸ“š", text: "Books" },
	{ path: daily_task_sets_path, icon: "ğŸ’ª", text: "Daily Task" },
	{ path: entries_path, icon: "ğŸŒ", text: "RSS" },
	{ path: links_path, icon: "ğŸ”—", text: "Links" },
	{ path: review_tool_path, icon: "ğŸ“", text: "Review Tool" },
	{ path: authorization_tokens_path, icon: "ğŸ”", text: "Authorization Tokens" }
]

%>

<div data-controller="sidebar" class="dark:bg-gray-900 dark:text-gray-100">
	<div class="flex pl-2 sticky top-0 sm:pt-3 sm:px-0 sm:flex-col sm:h-full sm:w-16 lg:w-60" >
		<div class="inline-block text-2xl h-12 sm:hidden">
			<button data-action="click->sidebar#toggle">...</button>
		</div>

		<div class="flex space-x-4 items-center ml-2 sm:ml-0 sm:py-2 sm:px-5">
				<h2 class="text-lg font-semibold">
					<%= link_to root_path do %>
						<span>H</span><span class="inline-block sm:hidden lg:inline-block">ayate</span>
					<% end %>
				</h2>
		</div>

		<div class="divide-y dark:divide-gray-700 hidden sm:inline-block">
			<ul class="flex text-sm space-y-1 flex-col px-2">
				<% links.each do |l| %><%= sidebar_link_to l %><% end %>
			</ul>
		</div>

		<div class="flex items-center ml-auto mr-2 sm:ml-0 sm:p-2 sm:mt-auto">
			<%= link_to 'Sign Out', signout_path, data: { "turbo-method": :delete } %>
		</div>
	</div>

	<div
		class="divide-y hidden sm:hidden relative"
		data-sidebar-target="links"
	>
		<div class="dark:bg-gray-900 dark:text-gray-100 absolute top-0 left-0 z-20">
			<ul class="flex text-sm space-y-1 flex-col px-2">
				<% links.each do |l| %><%= sidebar_link_to l %><% end %>
			</ul>
		</div>

		<div class="z-10 absolute -top-12 left-0 w-dvw h-dvh" data-action="click->sidebar#close"></div>
		</div>
	</div>
</div> <!-- data-controller="sidebar" -->
