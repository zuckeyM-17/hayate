<% content_for(:page_title) { 'Tasks' } %>

<%= render 'shared/breadcrumb' %>
<div class="p-4">
  <%= render 'shared/header', title: 'Tasks' %>

  <div class="pt-4 w-full flex flex-col items-center">
    <div class="p-4 w-full bg-gray-200 rounded-md lg:w-8/12">
      <%= form_for @task do |f| %>
      <div class="mt-2">
        <%= f.text_field :title, class: 'w-full' %>
      </div>
      <div class="mt-2">
        <%= f.select :category, Task.categories.keys, {}, class: "rounded-md focus:ring focus:ri focus:ri dark:border-gray-700 dark:text-gray-900"%>
      </div>
      <div class="mt-2">
        <%= f.date_field :start_date %> ~ <%= f.date_field :end_date %>
      </div>
      <div class="mt-2">
        <%= f.submit 'Add', class: "bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" %>
      </div>
      <% end %>
    </div>
    
    <div class="pt-4 w-full lg:w-8/12">
      <div class="flex items-center h-12">
        <div class="w-12"></div>
        <div class="grow">Title</div>
        <div class="w-32">Category</div>
        <div class="w-48">Date</div>
        <div class="w-12"></div>
      </div>
      <%= turbo_frame_tag 'tasks-list' do %>
      <% @tasks.each do |t| %>
        <%= turbo_frame_tag "task-#{t.id}" do %>
          <div class="flex items-center h-12 border-t">
            <div class="w-12">
              <% if t.done? %>
                ✅
              <% else %>
                <%= link_to '⬜️', done_task_path(t), data: { "turbo-method": :patch } %>
              <% end %>
            </div>
            <div class="grow"><span class="line-clamp-1"><%= t.title %></span></div>
            <div class="w-32"><%= task_category(t.category) %></div>
            <div class="w-48 text-sm"><%= "#{l(t.start_date)} ~ #{l(t.end_date)}" %></div>
            <div class="w-12"><%= link_to '🗑️', task_path(t), data: { "turbo-method": :delete } %></div>
          </div>
        <% end %>
      <% end%>
      <% end %> <!-- turbo_flame_tag -->
    </div>

  </div>
</div>